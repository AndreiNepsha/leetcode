class Solution:
    def minimizeArrayValue(self, nums: list[int]) -> int:
        li = len(nums) - 1
        while True:
            i = li
            changes = False
            while i > 1:
                k = i - 1
                s = nums[i]
                while k >= 0 and nums[i] > nums[k]:
                    s += nums[k]
                    k -= 1
                    changes = True
                v = s // (i - k + 1)
                for ii in range(k + 1, i + 1):
                    nums[ii] = v
                nums[k] += s % (i - k + 1)
                i = k
            print(nums)
            if not changes:
                break
        return max(nums)

    # def minimizeArrayValue(self, nums: list[int]) -> int:
    #     li = len(nums) - 1
    #     while True:
    #         i = 0
    #         changes = False
    #         while i < li:
    #             # if nums[i] < nums[i + 1]:
    #             #     k = i - 1
    #             #     while k > 0 and nums[k] < nums[i + 1]:
    #             #         k -= 1
    #             #         changes = True
    #             #     s = sum(nums[k:i + 2])
    #             #     v = s // (i + 2 - k)
    #             #     for ii in range(k, i + 2):
    #             #         nums[ii] = v
    #             #     nums[i + 1] += s % (i + 2 - k)
    #             if nums[i] < nums[i + 1]:
    #                 d = nums[i + 1] - nums[i]
    #                 d = d // 2 + d % 2
    #                 nums[i] += d
    #                 nums[i + 1] -= d
    #                 changes = True
    #             i += 1
    #         # print(nums)
    #         if not changes:
    #             break
    #     return max(nums)


# nums = [1, 2, 1, 1, 1, 900000, 10, 20, 899999]
# answer = Solution().minimizeArrayValue(nums)
# assert 200004 == answer, answer

nums = [3, 7, 1, 6]
answer = Solution().minimizeArrayValue(nums)
assert 5 == answer, answer

nums = [10, 1]
answer = Solution().minimizeArrayValue(nums)
assert 10 == answer, answer

nums = [3, 8, 12, 3, 5, 1, 7]
answer = Solution().minimizeArrayValue(nums)
assert 8 == answer, answer

nums = [13, 13, 20, 0, 8, 9, 9]
answer = Solution().minimizeArrayValue(nums)
assert 16 == answer, answer


nums = [
    347368488,
    21594307,
    384640267,
    788567145,
    925626318,
    567861892,
    541395464,
    802853378,
    227366587,
    378970433,
    68978593,
    316246593,
    316367070,
    450398095,
    427507019,
    182901527,
    658829591,
    939771618,
    573799685,
    733997662,
    316037938,
    98422477,
    358497904,
    309197850,
    863870239,
    177100463,
    715354515,
    853183370,
    298759115,
    941124436,
    115431723,
    432796680,
    331550301,
    726282960,
    471481002,
    827721676,
    787305073,
    731722693,
    692177832,
    645200306,
    12481267,
    586946498,
    685678883,
    491099884,
    304218905,
    461855126,
    286445948,
    754830306,
    641442098,
    410707913,
    8934696,
    681922564,
    576066511,
    114242195,
    614171598,
    965857563,
    698850294,
    424867758,
    481416799,
    622575457,
    942325197,
    597162875,
    330857963,
    999639455,
    140814688,
    285091994,
    616484087,
    416248090,
    379329373,
    445395459,
    213312185,
    933232152,
    277219445,
    841710874,
    400695658,
    945647887,
    45112473,
    582225926,
    469305721,
    186846313,
    759897022,
    762674367,
    574988286,
    452265315,
    75055446,
    684681617,
    394752286,
    193268976,
    440508223,
    577807128,
    78409462,
    74227599,
    513406083,
    174556668,
    608843939,
    397654405,
    172721547,
    184455752,
    966109024,
    646738571,
    860588727,
    519215943,
    60344732,
    433021494,
    458798691,
    861704067,
    918181228,
    358638190,
    200882533,
    48831830,
    473970513,
    996084849,
    653996499,
    678070335,
    859815967,
    452604396,
    185791829,
    963168307,
    248585968,
    436206886,
    532850222,
    534547831,
    438583208,
    183516558,
    704771516,
    222860503,
    323090972,
    655306410,
    91904817,
    209196979,
    19851701,
    252711794,
    201802324,
    516788781,
    90837759,
    298860998,
    360602901,
    349575020,
    174522350,
    791997581,
    66878120,
    16928267,
    671881804,
    57343901,
    37853733,
    124016228,
    597620488,
    647041044,
    600806139,
    60779068,
    301282196,
    249063038,
    306706886,
    838370959,
    812200547,
    992950775,
    72914073,
    989280579,
    95397377,
    360758427,
    806999052,
    500705213,
    73541340,
    715637207,
    371276759,
    311236117,
    77563739,
    734159938,
    956275718,
    262083222,
    472846601,
    767526893,
    679794793,
    533588725,
    778226983,
    327381098,
    500415586,
    522121545,
    348048921,
    244565961,
    810011135,
    421223611,
    500342623,
    981035751,
    568723121,
    985328387,
    892617185,
    194166603,
    129239995,
    216381128,
    511779192,
    986728778,
    381285538,
    785113116,
    439527021,
    958750995,
    406302475,
    795606584,
    271812680,
    801905709,
    480554570,
    179130871,
    961440427,
    996771190,
    664596281,
    362707163,
    424602176,
    14466687,
    977585173,
    854726221,
    634952921,
    565447967,
    272134812,
    625003126,
    354040024,
    259721518,
    736707212,
    654176330,
    687416843,
    619674400,
    218667300,
    64324137,
    350153475,
    952871389,
    202525262,
    629987278,
    67948292,
    705949056,
    841735344,
    974268398,
    639533439,
    323787910,
    592899881,
    810893944,
    470728154,
    748070216,
    877460651,
    37744345,
    468868666,
    445945964,
    706605664,
    392771803,
    568604637,
    163173405,
    909815049,
    711690236,
    908115921,
    355765731,
    770963778,
    428118289,
    763938314,
    240856833,
    878896579,
    669911171,
    138123296,
    364183930,
    921200445,
    6514872,
    903039219,
    721323621,
    236193936,
    812427115,
    153541911,
    306747746,
    640226597,
    7168978,
    443692407,
    793754899,
    982111837,
    936577739,
    741676302,
    670392614,
    177422017,
    962366423,
    590081082,
    855089821,
    140536639,
    625990442,
    247227032,
    100201830,
    179491099,
    146780803,
    165404637,
    196406453,
    403851889,
    596189773,
    954121170,
    406779032,
    260734276,
    435741932,
    74937379,
    694377518,
    381340845,
    59227161,
    228159046,
    928068943,
    971878049,
    940846456,
    805953076,
    245053621,
    39107816,
    464837433,
    365688691,
    166550274,
    875906603,
    463646092,
    240267725,
    583459479,
    467939954,
    929106836,
    395787731,
    910953960,
    555074614,
    499005161,
    460986485,
    87302671,
    435951504,
    318902148,
    382318102,
    826621174,
    432277621,
    136073464,
    15969921,
    171398130,
    596787147,
    108089313,
    828740192,
    920080614,
    254880001,
    930808915,
    516320503,
    211945289,
    785258699,
    902193734,
    217364739,
    613383336,
    251399973,
    796541919,
    101086423,
    832396984,
    530662536,
    329472654,
    84215450,
    975491118,
    382532094,
    928259065,
    291499051,
    180845632,
    987027519,
    100258414,
    987186772,
    869465680,
    57852033,
    148917310,
    565813318,
    26580338,
    395525563,
    222615278,
    705956966,
    185515386,
    326802889,
    304021298,
    160431454,
    609418729,
    45342651,
    888129522,
    520076295,
    391144365,
    695117862,
    504633237,
    130422820,
    355274441,
    669243037,
    171362857,
    740443472,
    300053498,
    360706801,
    746287743,
    904145849,
    386467430,
    319282802,
    340966895,
    442355131,
    564143483,
    318063114,
    850647783,
    795718639,
    12328071,
    477831608,
    399771825,
    842774735,
    452199511,
    221050358,
    979701226,
    184134961,
    607202807,
    866039925,
    801482998,
    861918780,
    462702430,
    523952313,
    482782901,
    161607167,
    971796423,
    264777816,
    221789243,
    615180624,
    729464842,
    530703682,
    453181364,
    796787775,
    882478369,
    738995389,
    733636412,
    809465847,
    361531369,
    511028220,
    692385581,
    943106464,
    283536870,
    131789973,
    265481896,
    285270418,
    133104955,
    279166006,
    759465577,
    989532832,
    624469644,
    525211811,
    775963040,
    619581836,
    661946749,
    641477198,
    670128199,
    892661794,
    594996156,
    893818885,
    898559634,
    610943434,
    224783854,
    601863010,
    566514949,
    148005024,
    200920083,
    817361,
    72019228,
    724200674,
    380544045,
    452483612,
    749341682,
    862353438,
    214219928,
    15175466,
    651085987,
    60965374,
    336927629,
    907593023,
    629143364,
    71212374,
    998152392,
    908427857,
    302726205,
    475474403,
    631914650,
    161787388,
    383915105,
    264805437,
    338930162,
    848068664,
    367370048,
    634333837,
    47397364,
    169753318,
    565043922,
    578497288,
    145293931,
    996164507,
    904805970,
    906971513,
    400855517,
    3127207,
    941858447,
    280803904,
    608806455,
    252666219,
    912269131,
    768297223,
    441850323,
    401082057,
    713428251,
    71312505,
    963844746,
    595929689,
    611031187,
    530387913,
    432062668,
    263750549,
    231275142,
    363636232,
    552703663,
    324044045,
    581031305,
    54898663,
    550795806,
    19771463,
    383135324,
    475720559,
    916689136,
    191349726,
    394782428,
    299278162,
    290826716,
    585938926,
    257664994,
    996049939,
    286336204,
    271640256,
    98348412,
    343522269,
    442941446,
    546599188,
    266043206,
    314099529,
    43137161,
    172066770,
    404150253,
    268994131,
    643458375,
    680472907,
    177447660,
    826992548,
    951465443,
    736106037,
    990319054,
    856455703,
    82433586,
    790553495,
    962265183,
    851432444,
    388168294,
    187059500,
    441446523,
    762526145,
    748934388,
    277494879,
    556596738,
    161104869,
    67339538,
    946748568,
    649985772,
    879897029,
    460731519,
    480163709,
    444882140,
    905494362,
    37119067,
    967024532,
    597547043,
    478914813,
    715099178,
    769646604,
    445327462,
    178425334,
    246513934,
    915406189,
    521704226,
    242975288,
    15192065,
    547388815,
    651482576,
    57623280,
    789678021,
    294522622,
    285159573,
    468562855,
    194399772,
    257710566,
    738730364,
    573139004,
    476679753,
    571945602,
    694633588,
    362847245,
    332700869,
    874862180,
    413247366,
    929643348,
    350877640,
    498143659,
    534589898,
    254833878,
    244038890,
    813801248,
    958333068,
    131855835,
    502076570,
    46146885,
    852356205,
    159485005,
    528855366,
    197920436,
    897843805,
    77903598,
    277604818,
    932311266,
    104952572,
    595366283,
    889059604,
    197579275,
    921366205,
    546544707,
    872526319,
    522620771,
    406049988,
    570481257,
    624174062,
    133226344,
    864712915,
    493842784,
    273288074,
    378848368,
    504965583,
    29359935,
    464436115,
    217249610,
    517556900,
    349972207,
    913675357,
    970499989,
    374091280,
    462673339,
    305346825,
    336644211,
    102810484,
    24207955,
    306621727,
    194127322,
    6755388,
    103575384,
    784058289,
    878319117,
    915928564,
    551501814,
    383280110,
    595724496,
    816716391,
    814099236,
    802990506,
    262118490,
    907154534,
    64911947,
    639215220,
    312634023,
    670407879,
    268847711,
    906613726,
    217261818,
    749218615,
    755100773,
    211386070,
    723726446,
    130427624,
    605851733,
    250587869,
    548323438,
    914224510,
    768039434,
    151340383,
    581706354,
    18123200,
    848995721,
    41765607,
    731195560,
    843416461,
    294017898,
    754323423,
    198452559,
    838850886,
    780812364,
    269457541,
    326325966,
    576498870,
    677260663,
    800119765,
    670054351,
    622770077,
    508563802,
    301357040,
    731052828,
    453022375,
    589333872,
    694751919,
    452247496,
    573188134,
    373892592,
    649765385,
    821090779,
    512045835,
    222542542,
    213597366,
    457473880,
    680363388,
    411543877,
    818370355,
    309391683,
    774875955,
    635449731,
    61619396,
    209130112,
    590874883,
    418140338,
    154161424,
    29114628,
    388238195,
    36371001,
    90942946,
    85290412,
    938322174,
    890878552,
    163396036,
    699208718,
    28147666,
    823062543,
    350845709,
    624685359,
    823210566,
    138302416,
    170816650,
    236293379,
    190517955,
    720347366,
    386416520,
    470388638,
    820525375,
    26134793,
    379397853,
    301092728,
    236908917,
    565748505,
    651414426,
    578067797,
    837378876,
    366469926,
    56941379,
    48706619,
    535029380,
    854045724,
    223029102,
    945138723,
    250766506,
    968141160,
    187123753,
    824777225,
    307597182,
    369678075,
    237616283,
    655230109,
    289494253,
    774116047,
    196605114,
    799592959,
    650655964,
    623750082,
    800704638,
    644129914,
    279362385,
    940808548,
    136572195,
    160507890,
    945129591,
    565793616,
    576588077,
    744880847,
    314908432,
    539128585,
    769314054,
    490584007,
    82890348,
    590463481,
    973725838,
    709467413,
    463518383,
    793373981,
    502969237,
    775005358,
    81716335,
    95698658,
    150827894,
    39622828,
    443190710,
    669574733,
    792245427,
    676861977,
    648641462,
    107673178,
    510986053,
    855699410,
    914490632,
    297544225,
    247075477,
    825355758,
    748099201,
    830797529,
    981887973,
    150734996,
    135971645,
    803168813,
    201199566,
    487377088,
    324979864,
    898127711,
    588155479,
    843917198,
    149921152,
    70364522,
    257233156,
    680062998,
    363772909,
    671106226,
    306351447,
    157432007,
    154119820,
    983168661,
    214588693,
    876742847,
    835934824,
    293627095,
    218873791,
    655642416,
    138674514,
    491589195,
    489678284,
    121771199,
    369616563,
    495233627,
    613755980,
    811412073,
    616201691,
    581498920,
    592975540,
    530230958,
    5155257,
    685498600,
]
answer = Solution().minimizeArrayValue(nums)
assert 547488408 == answer, answer

nums = [3, 7, 1, 6]
answer = Solution().minimizeArrayValue(nums)
assert 5 == answer, answer

nums = [10, 1]
answer = Solution().minimizeArrayValue(nums)
assert 10 == answer, answer

nums = [3, 8, 12, 3, 5, 1, 7]
answer = Solution().minimizeArrayValue(nums)
assert 8 == answer, answer

nums = [13, 13, 20, 0, 8, 9, 9]
answer = Solution().minimizeArrayValue(nums)
assert 16 == answer, answer
