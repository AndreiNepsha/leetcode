from time import time


class Solution:
    def longestArithSeqLength(self, nums: list[int]) -> int:
        dp = {}

        for r in range(1, len(nums)):
            for l in range(0, r):
                step = nums[r] - nums[l]
                dp[(r, step)] = 1 + dp.get((l, step), 1)

        return max(dp.values())


nums = [44,46,22,68,45,66,43,9,37,30,50,67,32,47,44,11,15,4,11,6,20,64,54,54,61,63,23,43,3,12,51,61,16,57,14,12,55,17,18,25,19,28,45,56,29,39,52,8,1,21,17,21,23,70,51,61,21,52,25,28]
a = Solution().longestArithSeqLength(nums)
assert 6 == a, a

nums = [3,6,9,12]
a = Solution().longestArithSeqLength(nums)
assert 4 == a, a

nums = [9,4,7,2,10]
a = Solution().longestArithSeqLength(nums)
assert 3 == a, a

nums = [20,1,15,3,10,5,8,0]
a = Solution().longestArithSeqLength(nums)
assert 5 == a, a

s = time()
nums = [160,254,459,57,231,85,48,23,324,491,224,55,286,169,209,398,168,10,17,236,171,36,455,279,36,217,323,357,89,99,129,79,251,63,462,342,446,315,207,159,62,334,193,482,322,234,143,131,225,420,105,294,43,470,325,285,88,245,115,446,227,190,276,484,452,348,244,222,202,73,335,289,363,306,310,113,212,9,9,434,197,5,141,11,316,378,280,446,62,147,53,195,78,74,145,153,346,81,153,442,239,384,357,401,282,269,325,227,183,44,13,367,195,381,251,244,304,297,159,367,444,77,80,24,327,477,122,405,221,170,301,210,385,37,353,53,140,347,358,106,86,244,234,443,50,384,379,279,434,15,77,187,41,445,7,426,473,493,178,21,317,112,125,322,247,335,88,31,474,36,461,113,262,361,17,451,273,391,68,49,210,408,58,387,479,391,320,43,17,332,447,389,218,226,405,392,397,464,7,442,142,367,373,263,210,439,11,76,149,301,140,84,235,155,342,364,157,116,144,478,252,95,248,184,161,392,218,161,130,96,38,213,337,22,151,296,483,134,450,276,131,77,426,48,330,451,203,38,56,225,382,72,233,254,211,367,464,152,453,170,373,131,130,117,187,82,253,428,470,364,265,387,319,35,326,473,121,267,293,225,139,114,208,338,495,91,249,414,491,89,278,452,113,290,60,52,352,386,77,287,208,372,464,440,140,163,404,475,159,497,378,445,49,190,116,426,411,99,253,261,20,216,10,29,274,394,123,166,482,249,320,219,336,157,214,97,490,468,140,347,348,74,166,352,419,341,90,341,129,168,77,394,496,85,253,135,430,51,82,71,25,333,403,82,213,78,239,429,194,291,158,244,46,177,485,200,441,375,213,85,413,220,53,87,384,169,33,79,109,235,169,257,391,137,83,382,256,139,283,472,311,300,35,391,450,296,84,414,261,344,250,410,8,278,104,309,152,302,447,387,150,500,330,462,176,254,488,113,284,394,260,280,72,107,73,125,63,219,385,277,287,51,459,140,133,360,186,82,42,111,374,140,230,176,280,181,312,26,409,342,435,14,84,419,348,6,51,160,407,429,375,449,181,210,171,54,136,147,339,314,282,259,432,398,172,367,246,264,255,284,38,316,40,310,54,268,194,253,290,461,243,348,226,188,63,73,266,45,396,395,82,186,443,493,360,373,306,171,449,262,497,148,161,419,207,167,379,73,395,413,414,195,322,264,489,19,302,234,10,474,296,80,16,254,429,183,168,69,206,195,170,222,397,277,237,53,258,45,359,210,54,131,317,24,76,403,405,454,280,153,471,223,333,473,240,326,27,38,478,107,54,255,98,496,169,35,308,461,362,376,152,144,468,484,126,204,231,151,363,84,255,320,15,327,334,231,324,311,490,60,186,402,211,321,309,287,6,31,26,129,104,260,275,149,349,424,224,433,399,420,78,276,457,65,1,160,448,447,198,464,224,105,28,200,169,267,157,287,57,260,339,27,494,491,476,47,298,114,35,104,48,238,208,298,414,464,299,186,64,288,29,329,75]
a = Solution().longestArithSeqLength(nums)
print(time() - s)
assert 8 == a, a
